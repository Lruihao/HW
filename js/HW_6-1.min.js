let inputValue="0";
$(document).ready(function(){0!==localStorage.length&&($(".history1").html(localStorage.calcuHist1),$(".history2").html(localStorage.calcuHist2));$("button").on("click",function(){let a=$(this).text();"="!==a&&"AC"!==a&&"\u2190"!==a&&checkOut(a)&&(inputValue+=a,$(".input-calc").val(inputValue))});$(".calculate").on("click",function(){calculate()});$(".clear").on("click",function(){clear()});$(".del-char").on("click",function(){delChar()});$(document).on("keypress",function(){event.preventDefault();let a=
event.key;/[-/*+.0-9]/.test(a)&&checkOut(a)?(inputValue+=a,$(".input-calc").val(inputValue)):"Enter"===a&&calculate()});$(document).on("keyup",function(){8===event.keyCode&&delChar();event.altKey&&8===event.keyCode&&clear()})});function clear(){$(".input-calc").val("0");inputValue="0"}function delChar(){0!==inputValue.length&&(inputValue=inputValue.slice(0,-1),$(".input-calc").val(0!==inputValue.length?inputValue:0),0===inputValue.length&&(inputValue="0"))}
function checkOut(a){var c=inputValue.slice(0,1),b=inputValue.slice(-1);if(21<=inputValue.length)return $(".tip").html("&emsp;\u8f38\u5165\u5167\u5bb9\u8d85\u904e\u6700\u5927\u9577\u5ea6\uff01&emsp;"),setTimeout(function(){$(".tip").html("")},3E3),!1;if("="!==a&&-1==="/*-+.".indexOf(a)&&"0"===c&&1===inputValue.length)return inputValue=a,$(".input-calc").val(inputValue),!1;if(-1<"/*-+.".indexOf(a)&&"/*-+.".indexOf(b)==="/*-+.".indexOf(a))return!1;if(-1<"/*-+".indexOf(a)&&-1<"/*-+.".indexOf(b)&&"/*-+".indexOf(b)!==
"/*-+".indexOf(a))inputValue=inputValue.slice(0,-1),$(".input-calc").val(inputValue);else if("."===a){a=-1;c=inputValue.lastIndexOf(".");for(b=0;4>b;b++){let d=inputValue.lastIndexOf("+-*/"[b]);a<d?a=d:""}if(c>a)return!1}return!0}
function calculate(){let a="",c=99;"-"===inputValue[0]&&(a="-",inputValue=inputValue.slice(1));for(;;){for(var b=0;4>b;b++){let a=inputValue.indexOf("+-*/"[b]);c>a&&0<a?c=a:""}if(99===c){-1===inputValue.indexOf(".")&&""!==inputValue?a+=parseInt(inputValue,10):""!==inputValue&&(a+=inputValue);break}b=inputValue.slice(0,c);a=-1===b.indexOf(".")?a+parseInt(b,10):a+b;inputValue=inputValue.slice(c);a+=inputValue.slice(0,1);inputValue=inputValue.slice(1);c=99}try{inputValue=a;let b=eval(a);b=eval(b.toFixed(14));
$(".input-calc").val(b);inputValue=b+"";$(".history1").html(`${$(".history2").html()}`);$(".history2").html(`${a}=${b}`);"undefined"===typeof localStorage?($(".tip").html("\u6d4f\u89c8\u5668\u4e0d\u652f\u6301localStorage\uff0c\u63a8\u8350\u4f7f\u7528Chrome\uff01"),setTimeout(function(){$(".tip").html("")},3E3)):(localStorage.calcuHist1=$(".history1").html(),localStorage.calcuHist2=$(".history2").html())}catch(d){$(".tip").html("&emsp;\u8acb\u8f38\u5165\u6b63\u78ba\u7684\u8868\u9054\u5f0f\uff01&emsp;"),
setTimeout(function(){$(".tip").html("")},3E3)}};