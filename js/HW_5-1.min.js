let nameNum=0;window.addEventListener("keydown",shortcutKeys);function shortcutKeys(){13===event.keyCode||119===event.keyCode?questionAdd():118===event.keyCode?save():event.altKey&&88===event.keyCode&&(document.querySelector(".question-type").value="text",document.querySelector("#required-item").checked=!1,clearLastInfo())}
function selectType(){switch(document.querySelector(".question-type").value){case "number":clearLastInfo();numberTpye();break;case "textarea":clearLastInfo();textareaType();break;case "radio":clearLastInfo();radioTpye();break;case "checkbox":clearLastInfo();checkType();break;default:clearLastInfo()}}
function questionAdd(){var a=document.querySelector(".question-type").value;let b=document.querySelector(".question-list");var c=document.querySelector("#required-item").checked?!0:!1;let f=document.querySelector(".question-title"),d=document.createElement("div");var e=document.createElement("div");let g=document.createElement("button"),k=document.createElement("button"),h=document.createElement("button"),l=document.createElement("img"),m=document.createElement("img"),p=document.createElement("img"),
q=document.createElement("span"),r=document.createElement("span"),v=document.createElement("span"),t=document.createElement("h4"),u=document.createElement("span"),n=document.createElement("input");d.className="question-item";e.className="detail-operation";g.addEventListener("click",deleteItem);k.addEventListener("click",moveDown);h.addEventListener("click",moveUp);l.src="../images/HW_5-1/delete.png";l.alt="\u522a\u9664";m.src="../images/HW_5-1/down.png";m.alt="\u4e0b\u79fb";p.src="../images/HW_5-1/up.png";
p.alt="\u4e0a\u79fb";q.innerHTML="\u522a\u9664";r.innerHTML="\u4e0b\u79fb";v.innerHTML="\u4e0a\u79fb";u.className="required-sign";u.innerHTML="*";g.appendChild(l);g.appendChild(q);k.appendChild(m);k.appendChild(r);h.appendChild(p);h.appendChild(v);e.appendChild(g);e.appendChild(k);e.appendChild(h);d.appendChild(e);d.appendChild(t);if(""===f.value)document.querySelector("header>span").innerHTML="\u8acb\u8f38\u5165\u984c\u76ee\uff01",setTimeout(function(){document.querySelector("header>span").innerHTML=
""},2E3);else{t.innerHTML=stringToEntity(f.value);c&&t.appendChild(u);switch(a){case "text":n.type="text";c?n.setAttribute("required",""):"";d.appendChild(n);break;case "password":n.type="password";c?n.setAttribute("required",""):"";d.appendChild(n);break;case "number":if(numberInfo(c)){d.appendChild(numberInfo(c));break}else return;case "textarea":a=document.createElement("textarea");c?a.setAttribute("required",""):"";d.appendChild(a);break;default:if(c=choiceInfo(c))for(c=c.childNodes,a=c.length,
e=0;e<a;e++)d.appendChild(c[0]);else return}b.appendChild(d);f.value=""}}function stringToEntity(a){let b=document.createElement("div");b.textContent=a;return b.innerHTML}function clearLastInfo(){document.querySelector(".question-title").value="";let a=document.querySelector(".question-preview");for(;a.hasChildNodes();)a.removeChild(a.firstChild)}
function numberInfo(a){let b=document.createElement("input"),c=document.querySelector("#check-min").checked,f=document.querySelector("#check-max").checked,d=document.querySelector("input[name='min-value']").value,e=document.querySelector("input[name='max-value']").value;if(f&&""===e)return document.querySelector("header>span").innerHTML="\u8acb\u8f38\u5165\u6700\u5927\u503c\uff01",setTimeout(function(){document.querySelector("header>span").innerHTML=""},2E3),!1;if(c&&""===d)return document.querySelector("header>span").innerHTML=
"\u8acb\u8f38\u5165\u6700\u5c0f\u503c\uff01",setTimeout(function(){document.querySelector("header>span").innerHTML=""},2E3),!1;if(c&&f&&d>=e)return document.querySelector("header>span").innerHTML="\u6700\u5c0f\u503c\u5927\u65bc\u6216\u7b49\u65bc\u6700\u5927\u503c\uff0c\u8acb\u91cd\u65b0\u8f38\u5165\uff01",setTimeout(function(){document.querySelector("header>span").innerHTML=""},2E3),!1;f?document.querySelector("input[name='max-value']").setAttribute("required",""):"";c?document.querySelector("input[name='min-value']").setAttribute("required",
""):"";b.type="number";c?b.min=d:"";f?b.max=e:"";a?b.setAttribute("required",""):"";return b}
function choiceInfo(a){let b=document.querySelector(".question-preview").childNodes,c=b.length/3,f=document.querySelector(".first-check").type,d=document.createElement("div"),e=document.createElement("br");for(var g=1;g<=c;g++)if(""===b[3*g-1].value)return document.querySelector("header>span").innerHTML=`\u8acb\u586b\u5beb\u9078\u9805 ${g}\uff01`,setTimeout(function(){document.querySelector("header>span").innerHTML=""},2E3),!1;for(g=1;g<=c;g++){let k=b[3*g-2].checked?!0:!1,h=document.createElement("input"),
l=document.createElement("label"),m=document.createElement("span");h.type=f;h.name=f+nameNum;k?h.setAttribute("checked",""):"";m.innerHTML=b[3*g-1].value;1===g&&(a?h.setAttribute("required",""):"");l.appendChild(h);l.appendChild(m);d.appendChild(l);g!==c?"":d.appendChild(e)}nameNum++;return d}
function numberTpye(){let a=document.querySelector(".question-preview"),b=document.createElement("span"),c=document.createElement("span"),f=document.createElement("label"),d=document.createElement("label"),e=document.createElement("input"),g=document.createElement("input"),k=document.createElement("input"),h=document.createElement("input"),l=document.createElement("span"),m=document.createElement("span"),p=document.createElement("br"),q=document.createElement("br"),r=document.createElement("br");
b.innerHTML="\u6700\u5927\u503c";c.innerHTML="\u6700\u5c0f\u503c";f.for="check-max";d.for="check-min";e.id="check-max";g.id="check-min";e.type=g.type="checkbox";l.innerHTML="\u8a2d\u7f6e\u6700\u5927\u503c";m.innerHTML="\u8a2d\u7f6e\u6700\u5c0f\u503c";k.type=h.type="number";k.placeholder="\u6700\u5927\u6578\u5b57";h.placeholder="\u6700\u5c0f\u6578\u5b57";k.name="max-value";h.name="min-value";f.appendChild(e);d.appendChild(g);f.appendChild(l);d.appendChild(m);a.appendChild(b);a.appendChild(f);a.appendChild(p);
a.appendChild(k);a.appendChild(q);a.appendChild(c);a.appendChild(d);a.appendChild(r);a.appendChild(h)}function textareaType(){let a=document.createElement("textarea");document.querySelector(".question-preview").appendChild(a)}
function radioTpye(){let a=document.querySelector(".question-preview"),b=document.createElement("span"),c=document.createElement("input"),f=document.createElement("input"),d=document.createElement("input"),e=document.createElement("input"),g=document.createElement("br");b.innerHTML="\u9078&emsp;&emsp;\u9805";c.type=c.name=f.type=f.name="radio";c.className="first-check";d.type=e.type="text";d.placeholder="\u8acb\u8f38\u5165\u9078\u9805\u540d\u7a31";e.placeholder="\u96d9\u64ca\u65b0\u589e\u9078\u9805";
d.setAttribute("required","");e.setAttribute("required","");e.className="add-choice";e.addEventListener("dblclick",addChoice);a.appendChild(b);a.appendChild(c);a.appendChild(d);a.appendChild(g);a.appendChild(f);a.appendChild(e)}
function checkType(){let a=document.querySelector(".question-preview"),b=document.createElement("span"),c=document.createElement("input"),f=document.createElement("input"),d=document.createElement("input"),e=document.createElement("input"),g=document.createElement("br");b.innerHTML="\u9078&emsp;&emsp;\u9805";c.type=c.name=f.type=f.name="checkbox";c.className="first-check";d.type=e.type="text";d.placeholder="\u8acb\u8f38\u5165\u9078\u9805\u540d\u7a31";e.placeholder="\u96d9\u64ca\u65b0\u589e\u9078\u9805";
d.setAttribute("required","");e.setAttribute("required","");e.className="add-choice";e.addEventListener("dblclick",addChoice);a.appendChild(b);a.appendChild(c);a.appendChild(d);a.appendChild(g);a.appendChild(f);a.appendChild(e)}
function addChoice(){let a=document.querySelector(".question-preview"),b=this.previousSibling,c=b.cloneNode(),f=document.createElement("input"),d=document.createElement("br");f.type="text";f.placeholder="\u8acb\u8f38\u5165\u9078\u9805\u540d\u7a31 \uff08DELETE\u9375\u522a\u9664\u9078\u9805\uff09";f.value=this.value;f.required=" ";this.value="";b.checked=!1;f.addEventListener("keydown",deleteChoice);a.insertBefore(c,b);a.insertBefore(f,b);a.insertBefore(d,b)}
function deleteChoice(){let a=document.querySelector(".question-preview");46===event.keyCode&&(a.removeChild(this.previousSibling),a.removeChild(this.nextSibling),a.removeChild(this))}function moveUp(){let a=this.parentNode.parentNode,b=a.parentNode;a!==b.firstChild?b.insertBefore(a,a.previousSibling):(document.querySelector("header>span").innerHTML="\u7b2c\u4e00\u9898\uff0c\u65e0\u6cd5\u4e0a\u79fb!",setTimeout(function(){document.querySelector("header>span").innerHTML=""},2E3))}
function moveDown(){let a=this.parentNode.parentNode,b=a.parentNode;a!==b.lastChild?b.insertBefore(a.nextSibling,a):(document.querySelector("header>span").innerHTML="\u6700\u540e\u4e00\u9898\uff0c\u65e0\u6cd5\u4e0b\u79fb!",setTimeout(function(){document.querySelector("header>span").innerHTML=""},2E3))}function deleteItem(){let a=this.parentNode.parentNode;a.parentNode.removeChild(a)}
function save(){""===document.querySelector(".question-list").innerHTML?(document.querySelector("header>span").innerHTML="\u554f\u5377\u5167\u5bb9\u70ba\u7a7a\uff01",setTimeout(function(){document.querySelector("header>span").innerHTML=""},2E3)):"undefined"===typeof localStorage?(document.querySelector("header>span").innerHTML="\u6d4f\u89c8\u5668\u4e0d\u652f\u6301localStorage\uff0c\u63a8\u8350\u4f7f\u7528Chrome\uff01",setTimeout(function(){document.querySelector("header>span").innerHTML=""},2E3)):
(localStorage.questionList=document.querySelector(".question-list").innerHTML,document.querySelector("header>span").innerHTML="\u5df2\u4fdd\u5b58\uff01",setTimeout(function(){document.querySelector("header>span").innerHTML=""},2E3),window.open("./questions.html"))};